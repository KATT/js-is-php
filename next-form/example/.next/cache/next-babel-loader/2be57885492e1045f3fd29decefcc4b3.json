{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"/Users/alex/dev/js-is-php/next-form/example/pages/vanilla.tsx\",\n    _s = $RefreshSig$();\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport { useState } from 'react';\nimport { createForm } from 'next-form';\nimport { prettyDate } from 'utils/prettyDate';\nimport * as z from 'zod';\nexport var __N_SSP = true;\nexport var createPostForm = createForm({\n  schema: z.object({\n    from: z.string().min(2),\n    message: z.string().min(4)\n  }),\n  defaultValues: {\n    message: '',\n    from: ''\n  },\n  formId: 'createPost'\n});\nexport default function Home(props) {\n  _s();\n\n  var _this = this,\n      _form$response,\n      _form$response$error,\n      _form$response$error$,\n      _form$response2,\n      _form$response2$error,\n      _form$response2$error2,\n      _form$response3,\n      _form$response3$error,\n      _form$response3$error2,\n      _form$response4,\n      _form$response4$error,\n      _form$response4$error2,\n      _form$response5,\n      _form$response5$error,\n      _form$response5$error2,\n      _form$response6,\n      _form$response6$error,\n      _form$response6$error2;\n\n  var _useState = useState(createPostForm.getFeedbackFromProps(props)),\n      feedback = _useState[0],\n      setFeedback = _useState[1];\n\n  var initalValues = createPostForm.getInitialValues(props);\n  var form = props.createPost;\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n      children: \"Normal http post (zod for validation)\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 29,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n      children: [\"Uses a standard \", /*#__PURE__*/_jsxDEV(\"code\", {\n        children: \"<form>\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 31,\n        columnNumber: 25\n      }, this), \" with the \", /*#__PURE__*/_jsxDEV(\"code\", {\n        children: \"action\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 31,\n        columnNumber: 60\n      }, this), \"-attribute to post to the same page. Form data is handled in\", ' ', /*#__PURE__*/_jsxDEV(\"code\", {\n        children: \"getServerSideProps\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 33,\n        columnNumber: 9\n      }, this), \" and feedback is passed through page props.\"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 30,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n      children: \"My Guestbook\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 36,\n      columnNumber: 7\n    }, this), props.posts.map(function (item) {\n      return /*#__PURE__*/_jsxDEV(\"article\", {\n        children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n          children: [\"From \", item.from, \" at \", prettyDate(item.createdAt), \":\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 39,\n          columnNumber: 11\n        }, _this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"message\",\n          children: item.message\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 42,\n          columnNumber: 11\n        }, _this)]\n      }, item.id, true, {\n        fileName: _jsxFileName,\n        lineNumber: 38,\n        columnNumber: 9\n      }, _this);\n    }), /*#__PURE__*/_jsxDEV(\"h3\", {\n      children: \"Add post\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 45,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n      action: props.createPost.endpoints.action,\n      method: \"post\",\n      children: [/*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"field \".concat(((_form$response = form.response) === null || _form$response === void 0 ? void 0 : (_form$response$error = _form$response.error) === null || _form$response$error === void 0 ? void 0 : (_form$response$error$ = _form$response$error.fieldErrors) === null || _form$response$error$ === void 0 ? void 0 : _form$response$error$.from) ? 'field--error' : ''),\n        children: /*#__PURE__*/_jsxDEV(\"label\", {\n          children: [\"Your name:\", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 55,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"text\",\n            name: \"from\",\n            defaultValue: initalValues.from\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 56,\n            columnNumber: 13\n          }, this), ((_form$response2 = form.response) === null || _form$response2 === void 0 ? void 0 : (_form$response2$error = _form$response2.error) === null || _form$response2$error === void 0 ? void 0 : (_form$response2$error2 = _form$response2$error.fieldErrors) === null || _form$response2$error2 === void 0 ? void 0 : _form$response2$error2.from) && /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"field__error\",\n            children: (_form$response3 = form.response) === null || _form$response3 === void 0 ? void 0 : (_form$response3$error = _form$response3.error) === null || _form$response3$error === void 0 ? void 0 : (_form$response3$error2 = _form$response3$error.fieldErrors) === null || _form$response3$error2 === void 0 ? void 0 : _form$response3$error2.from\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 58,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 53,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 48,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"field \".concat(((_form$response4 = form.response) === null || _form$response4 === void 0 ? void 0 : (_form$response4$error = _form$response4.error) === null || _form$response4$error === void 0 ? void 0 : (_form$response4$error2 = _form$response4$error.fieldErrors) === null || _form$response4$error2 === void 0 ? void 0 : _form$response4$error2.message) ? 'field--error' : ''),\n        children: /*#__PURE__*/_jsxDEV(\"label\", {\n          children: [\"Your message:\", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 71,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n            name: \"message\",\n            defaultValue: initalValues.message\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 72,\n            columnNumber: 13\n          }, this), ((_form$response5 = form.response) === null || _form$response5 === void 0 ? void 0 : (_form$response5$error = _form$response5.error) === null || _form$response5$error === void 0 ? void 0 : (_form$response5$error2 = _form$response5$error.fieldErrors) === null || _form$response5$error2 === void 0 ? void 0 : _form$response5$error2.message) && /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"field__error\",\n            children: (_form$response6 = form.response) === null || _form$response6 === void 0 ? void 0 : (_form$response6$error = _form$response6.error) === null || _form$response6$error === void 0 ? void 0 : (_form$response6$error2 = _form$response6$error.fieldErrors) === null || _form$response6$error2 === void 0 ? void 0 : _form$response6$error2.message\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 74,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 69,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 64,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"submit\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 80,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 82,\n        columnNumber: 9\n      }, this), (feedback === null || feedback === void 0 ? void 0 : feedback.state) === 'success' && /*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"feedback success\",\n        children: \"Yay! Your entry was added\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 84,\n        columnNumber: 11\n      }, this), (feedback === null || feedback === void 0 ? void 0 : feedback.state) === 'error' && /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"feedback error\",\n          children: [\"Something went wrong: \", feedback.error.message, \". Full Error:\", ' ', /*#__PURE__*/_jsxDEV(\"pre\", {\n            children: JSON.stringify(_objectSpread(_objectSpread({}, feedback.error), {}, {\n              message: feedback.error.message,\n              stack: feedback.error.stack\n            }), null, 4)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 91,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 89,\n          columnNumber: 13\n        }, this)\n      }, void 0, false)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 47,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n}\n\n_s(Home, \"cz6ktimFD7SwlUvAvdpez/Y8aoI=\");\n\n_c = Home;\n\nvar _c;\n\n$RefreshReg$(_c, \"Home\");","map":{"version":3,"sources":["/Users/alex/dev/js-is-php/next-form/example/pages/vanilla.tsx"],"names":["useState","createForm","prettyDate","z","createPostForm","schema","object","from","string","min","message","defaultValues","formId","Home","props","getFeedbackFromProps","feedback","setFeedback","initalValues","getInitialValues","form","createPost","posts","map","item","createdAt","id","endpoints","action","response","error","fieldErrors","state","JSON","stringify","stack"],"mappings":"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","sourcesContent":["import { GetServerSidePropsContext, InferGetServerSidePropsType } from 'next';\nimport { useState } from 'react';\nimport { createForm } from 'next-form';\nimport { DB } from 'utils/db';\nimport { prettyDate } from 'utils/prettyDate';\nimport * as z from 'zod';\n\nexport const createPostForm = createForm({\n  schema: z.object({\n    from: z.string().min(2),\n    message: z.string().min(4),\n  }),\n  defaultValues: {\n    message: '',\n    from: '',\n  },\n  formId: 'createPost',\n});\n\ntype Props = InferGetServerSidePropsType<typeof getServerSideProps>;\nexport default function Home(props: Props) {\n  const [feedback, setFeedback] = useState(\n    createPostForm.getFeedbackFromProps(props)\n  );\n  const initalValues = createPostForm.getInitialValues(props);\n  const form = props.createPost;\n  return (\n    <>\n      <h1>Normal http post (zod for validation)</h1>\n      <p>\n        Uses a standard <code>&lt;form&gt;</code> with the <code>action</code>\n        -attribute to post to the same page. Form data is handled in{' '}\n        <code>getServerSideProps</code> and feedback is passed through page\n        props.\n      </p>\n      <h2>My Guestbook</h2>\n      {props.posts.map(item => (\n        <article key={item.id}>\n          <strong>\n            From {item.from} at {prettyDate(item.createdAt)}:\n          </strong>\n          <p className=\"message\">{item.message}</p>\n        </article>\n      ))}\n      <h3>Add post</h3>\n\n      <form action={props.createPost.endpoints.action} method=\"post\">\n        <p\n          className={`field ${\n            form.response?.error?.fieldErrors?.from ? 'field--error' : ''\n          }`}\n        >\n          <label>\n            Your name:\n            <br />\n            <input type=\"text\" name=\"from\" defaultValue={initalValues.from} />\n            {form.response?.error?.fieldErrors?.from && (\n              <span className=\"field__error\">\n                {form.response?.error?.fieldErrors?.from}\n              </span>\n            )}\n          </label>\n        </p>\n        <p\n          className={`field ${\n            form.response?.error?.fieldErrors?.message ? 'field--error' : ''\n          }`}\n        >\n          <label>\n            Your message:\n            <br />\n            <textarea name=\"message\" defaultValue={initalValues.message} />\n            {form.response?.error?.fieldErrors?.message && (\n              <span className=\"field__error\">\n                {form.response?.error?.fieldErrors?.message}\n              </span>\n            )}\n          </label>\n        </p>\n        <input type=\"submit\" />\n\n        <br />\n        {feedback?.state === 'success' && (\n          <span className=\"feedback success\">Yay! Your entry was added</span>\n        )}\n\n        {feedback?.state === 'error' && (\n          <>\n            <span className=\"feedback error\">\n              Something went wrong: {feedback.error.message}. Full Error:{' '}\n              <pre>\n                {JSON.stringify(\n                  {\n                    ...feedback.error,\n                    message: feedback.error.message,\n                    stack: feedback.error.stack,\n                  },\n                  null,\n                  4\n                )}\n              </pre>\n            </span>\n          </>\n        )}\n      </form>\n    </>\n  );\n}\n\nexport const getServerSideProps = async (ctx: GetServerSidePropsContext) => {\n  const createPostProps = await createPostForm.getPageProps({\n    ctx,\n    async mutation(input) {\n      if (Math.random() < 0.3) {\n        throw new Error('Emulating the mutation failing');\n      }\n      return DB.createPost(input);\n    },\n  });\n\n  return {\n    props: {\n      ...createPostProps,\n      posts: await DB.getAllPosts(),\n    },\n  };\n};\n"]},"metadata":{},"sourceType":"module"}